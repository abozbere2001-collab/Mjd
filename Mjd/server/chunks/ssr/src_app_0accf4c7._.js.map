{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/privacy-policy/page.tsx"],"sourcesContent":["\n\"use client\";\n\nimport { ScreenHeader } from \"@/components/ScreenHeader\";\nimport { ScreenProps } from \"@/app/page\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\n\nexport default function PrivacyPolicyScreen({ navigate, goBack, canGoBack }: ScreenProps) {\n  const currentYear = new Date().getFullYear();\n  return (\n    <div className=\"flex flex-col h-full bg-background\">\n      <ScreenHeader title=\"سياسة الخصوصية\" onBack={goBack} canGoBack={true} />\n      <div className=\"flex-1 overflow-y-auto p-4\">\n        <Card>\n          <CardHeader>\n            <CardTitle>سياسة الخصوصية لتطبيق نبض الملاعب</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4 text-muted-foreground leading-relaxed\">\n            <p className=\"font-bold\">\n              تاريخ آخر تحديث: أكتوبر {currentYear}\n            </p>\n            <p>\n              نحن في نبض الملاعب (\"نحن\"، \"التطبيق\") نأخذ خصوصيتك على محمل الجد. توضح سياسة الخصوصية هذه كيفية جمعنا واستخدامنا وحماية معلوماتك الشخصية عند استخدامك لتطبيقنا وخدماتنا.\n            </p>\n            \n            <h3 className=\"font-bold text-lg text-foreground pt-4\">1. المعلومات التي نجمعها</h3>\n            <h4 className=\"font-semibold text-md text-foreground/90 pt-2\">أ. المعلومات التي تقدمها لنا مباشرة:</h4>\n            <ul className=\"list-disc pr-5 space-y-2\">\n              <li>\n                <b>معلومات الحساب:</b> عند تسجيل الدخول باستخدام حساب جوجل، نحصل على المعلومات الأساسية المرتبطة بحسابك مثل الاسم، البريد الإلكتروني، وصورة الملف الشخصي، وذلك لإنشاء حسابك وتخصيصه.\n              </li>\n              <li>\n                <b>المحتوى الذي تنشئه:</b> نجمع المحتوى الذي تقوم بإنشائه داخل التطبيق، مثل التعليقات على المباريات، وتوقعاتك للنتائج.\n              </li>\n            </ul>\n            <h4 className=\"font-semibold text-md text-foreground/90 pt-2\">ب. المعلومات التي نجمعها تلقائيًا:</h4>\n             <ul className=\"list-disc pr-5 space-y-2\">\n              <li>\n                <b>بيانات الاستخدام:</b> نجمع معلومات حول كيفية تفاعلك مع التطبيق، مثل الشاشات التي تزورها، والميزات التي تستخدمها، والفرق والبطولات التي تفضلها.\n              </li>\n               <li>\n                <b>بيانات الجهاز:</b> قد نجمع معلومات أساسية عن جهازك مثل نوعه ونظام التشغيل، وذلك لأغراض التحليل وتحسين التوافق.\n              </li>\n            </ul>\n\n            <h3 className=\"font-bold text-lg text-foreground pt-4\">2. كيف نستخدم معلوماتك</h3>\n            <p>نستخدم المعلومات التي نجمعها للأغراض التالية:</p>\n            <ul className=\"list-disc pr-5 space-y-2\">\n              <li><b>توفير وتخصيص خدماتنا:</b> لإدارة حسابك، وعرض المحتوى الذي يهمك بناءً على مفضلاتك.</li>\n              <li><b>التواصل معك:</b> لإرسال إشعارات حول التفاعلات مع تعليقاتك (الردود والإعجابات) أو إشعارات أخرى تختار تفعيلها.</li>\n              <li><b>تحسين التطبيق:</b> لتحليل بيانات الاستخدام وفهم سلوك المستخدمين، مما يساعدنا على تحسين أداء التطبيق وتطوير ميزات جديدة.</li>\n              <li><b>الأمان:</b> لحماية أمان حسابك وسلامة خدماتنا.</li>\n            </ul>\n\n            <h3 className=\"font-bold text-lg text-foreground pt-4\">3. مشاركة المعلومات</h3>\n            <p>\n              نحن لا نبيع أو نؤجر معلوماتك الشخصية لأي طرف ثالث. قد نشارك معلوماتك في الحالات المحدودة التالية:\n            </p>\n             <ul className=\"list-disc pr-5 space-y-2\">\n                <li><b>مقدمو الخدمات:</b> قد نستعين بخدمات أطراف ثالثة (مثل Firebase من Google) للمساعدة في تشغيل خدماتنا (مثل الاستضافة وقاعدة البيانات والمصادقة). تلتزم هذه الأطراف بالحفاظ على سرية معلوماتك.</li>\n                <li><b>لأسباب قانونية:</b> قد نكشف عن معلوماتك إذا كان ذلك مطلوبًا بموجب القانون أو استجابة لطلب قانوني صالح.</li>\n             </ul>\n\n            <h3 className=\"font-bold text-lg text-foreground pt-4\">4. أمان البيانات</h3>\n            <p>\n              نتخذ إجراءات أمنية معقولة وتقنيات متقدمة لحماية معلوماتك الشخصية من الوصول أو الاستخدام أو التغيير أو الكشف غير المصرح به. ومع ذلك، لا توجد طريقة نقل عبر الإنترنت أو تخزين إلكتروني آمنة بنسبة 100%.\n            </p>\n\n            <h3 className=\"font-bold text-lg text-foreground pt-4\">5. التغييرات على سياسة الخصوصية</h3>\n            <p>\n              قد نقوم بتحديث سياسة الخصوصية هذه من وقت لآخر. سنعلمك بأي تغييرات جوهرية عن طريق نشر السياسة الجديدة على هذه الصفحة و/أو من خلال إشعار داخل التطبيق.\n            </p>\n            \n            <h3 className=\"font-bold text-lg text-foreground pt-4\">6. اتصل بنا</h3>\n            <p>\n              إذا كان لديك أي أسئلة أو استفسارات حول سياسة الخصوصية هذه، فلا تتردد في التواصل معنا.\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAGA;AAEA;AAJA;;;;AAMe,SAAS,oBAAoB,EAAE,QAAQ,EAAE,MAAM,EAAE,SAAS,EAAe;IACtF,MAAM,cAAc,IAAI,OAAO,WAAW;IAC1C,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,kIAAA,CAAA,eAAY;gBAAC,OAAM;gBAAiB,QAAQ;gBAAQ,WAAW;;;;;;0BAChE,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC,gIAAA,CAAA,OAAI;;sCACH,8OAAC,gIAAA,CAAA,aAAU;sCACT,cAAA,8OAAC,gIAAA,CAAA,YAAS;0CAAC;;;;;;;;;;;sCAEb,8OAAC,gIAAA,CAAA,cAAW;4BAAC,WAAU;;8CACrB,8OAAC;oCAAE,WAAU;;wCAAY;wCACE;;;;;;;8CAE3B,8OAAC;8CAAE;;;;;;8CAIH,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,8OAAC;oCAAG,WAAU;8CAAgD;;;;;;8CAC9D,8OAAC;oCAAG,WAAU;;sDACZ,8OAAC;;8DACC,8OAAC;8DAAE;;;;;;gDAAmB;;;;;;;sDAExB,8OAAC;;8DACC,8OAAC;8DAAE;;;;;;gDAAuB;;;;;;;;;;;;;8CAG9B,8OAAC;oCAAG,WAAU;8CAAgD;;;;;;8CAC7D,8OAAC;oCAAG,WAAU;;sDACb,8OAAC;;8DACC,8OAAC;8DAAE;;;;;;gDAAqB;;;;;;;sDAEzB,8OAAC;;8DACA,8OAAC;8DAAE;;;;;;gDAAkB;;;;;;;;;;;;;8CAIzB,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,8OAAC;8CAAE;;;;;;8CACH,8OAAC;oCAAG,WAAU;;sDACZ,8OAAC;;8DAAG,8OAAC;8DAAE;;;;;;gDAAyB;;;;;;;sDAChC,8OAAC;;8DAAG,8OAAC;8DAAE;;;;;;gDAAgB;;;;;;;sDACvB,8OAAC;;8DAAG,8OAAC;8DAAE;;;;;;gDAAkB;;;;;;;sDACzB,8OAAC;;8DAAG,8OAAC;8DAAE;;;;;;gDAAW;;;;;;;;;;;;;8CAGpB,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,8OAAC;8CAAE;;;;;;8CAGF,8OAAC;oCAAG,WAAU;;sDACX,8OAAC;;8DAAG,8OAAC;8DAAE;;;;;;gDAAkB;;;;;;;sDACzB,8OAAC;;8DAAG,8OAAC;8DAAE;;;;;;gDAAmB;;;;;;;;;;;;;8CAG9B,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,8OAAC;8CAAE;;;;;;8CAIH,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,8OAAC;8CAAE;;;;;;8CAIH,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,8OAAC;8CAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQf","debugId":null}},
    {"offset": {"line": 394, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/terms-of-service/page.tsx"],"sourcesContent":["\n\"use client\";\n\nimport { ScreenHeader } from \"@/components/ScreenHeader\";\nimport { ScreenProps } from \"@/app/page\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\n\nexport default function TermsOfServiceScreen({ navigate, goBack, canGoBack }: ScreenProps) {\n    const currentYear = new Date().getFullYear();\n  return (\n    <div className=\"flex flex-col h-full bg-background\">\n      <ScreenHeader title=\"شروط الخدمة\" onBack={goBack} canGoBack={true} />\n      <div className=\"flex-1 overflow-y-auto p-4\">\n        <Card>\n          <CardHeader>\n            <CardTitle>شروط الخدمة لتطبيق نبض الملاعب</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4 text-muted-foreground leading-relaxed\">\n            <p className=\"font-bold\">\n              مرحبًا بك في نبض الملاعب. باستخدامك لتطبيقنا (\"الخدمة\")، فإنك توافق على الالتزام بشروط وأحكام الخدمة هذه (\"الشروط\"). آخر تحديث: أكتوبر {currentYear}.\n            </p>\n\n            <h3 className=\"font-bold text-lg text-foreground pt-4\">1. قبول الشروط</h3>\n            <p>\n              من خلال الوصول إلى الخدمة أو استخدامها، فإنك توافق على الالتزام بهذه الشروط. إذا كنت لا توافق على أي جزء من الشروط، فلا يجوز لك الوصول إلى الخدمة.\n            </p>\n\n            <h3 className=\"font-bold text-lg text-foreground pt-4\">2. استخدام الخدمة</h3>\n            <p>\n              أنت توافق على استخدام الخدمة فقط للأغراض المشروعة ووفقًا لهذه الشروط. أنت مسؤول عن جميع الأنشطة التي تحدث تحت حسابك.\n            </p>\n            <ul className=\"list-disc pr-5 space-y-2\">\n                <li><b>السلوك المحظور:</b> يُحظر عليك استخدام الخدمة لنشر أي محتوى غير قانوني، أو افترائي، أو مسيء، أو يحض على الكراهية، أو ينتهك حقوق الآخرين.</li>\n                <li><b>حساب المستخدم:</b> أنت مسؤول عن الحفاظ على أمان حسابك. يجب ألا تشارك تفاصيل حسابك مع الآخرين.</li>\n            </ul>\n\n            <h3 className=\"font-bold text-lg text-foreground pt-4\">3. المحتوى الذي ينشئه المستخدم</h3>\n            <p>\n              أنت تحتفظ بملكية المحتوى الذي تقوم بإنشائه (مثل التعليقات والتوقعات). ومع ذلك، من خلال نشره على خدمتنا، فإنك تمنحنا ترخيصًا عالميًا، غير حصري، خاليًا من حقوق الملكية لاستخدام هذا المحتوى وعرضه وتوزيعه فيما يتعلق بتشغيل الخدمة.\n            </p>\n            <p>\n                نحتفظ بالحق في إزالة أي محتوى ينتهك هذه الشروط أو نعتبره غير لائق، دون إشعار مسبق.\n            </p>\n\n            <h3 className=\"font-bold text-lg text-foreground pt-4\">4. الملكية الفكرية</h3>\n            <p>\n              الخدمة وجميع محتوياتها الأصلية (باستثناء المحتوى الذي يقدمه المستخدمون)، والميزات، والوظائف هي وستبقى ملكية حصرية لـ نبض الملاعب ومرخصيها. خدمتنا محمية بموجب حقوق النشر والعلامات التجارية والقوانين الأخرى.\n            </p>\n\n            <h3 className=\"font-bold text-lg text-foreground pt-4\">5. دقة البيانات</h3>\n             <p>\n              بيانات المباريات والنتائج والإحصائيات يتم توفيرها من خلال أطراف ثالثة. على الرغم من أننا نسعى لتقديم معلومات دقيقة، إلا أننا لا نضمن دقتها أو اكتمالها أو توقيتها. يتم توفير المعلومات \"كما هي\" لأغراض إعلامية فقط.\n            </p>\n\n            <h3 className=\"font-bold text-lg text-foreground pt-4\">6. إنهاء الخدمة</h3>\n            <p>\n              يجوز لنا إنهاء أو تعليق حسابك ووصولك إلى الخدمة فورًا، دون إشعار مسبق، إذا انتهكت هذه الشروط. عند الإنهاء، ينتهي حقك في استخدام الخدمة فورًا.\n            </p>\n\n            <h3 className=\"font-bold text-lg text-foreground pt-4\">7. تحديد المسؤولية</h3>\n            <p>\n              لن يكون نبض الملاعب أو مديروه أو موظفوه مسؤولين بأي حال من الأحوال عن أي أضرار غير مباشرة أو عرضية أو خاصة أو تبعية تنشأ عن استخدامك أو عدم قدرتك على استخدام الخدمة.\n            </p>\n\n             <h3 className=\"font-bold text-lg text-foreground pt-4\">8. التغييرات على الشروط</h3>\n            <p>\n              نحتفظ بالحق، وفقًا لتقديرنا الخاص، في تعديل أو استبدال هذه الشروط في أي وقت. سنقدم إشعارًا بالتغييرات الجوهرية قبل دخولها حيز التنفيذ.\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAGA;AAEA;AAJA;;;;AAMe,SAAS,qBAAqB,EAAE,QAAQ,EAAE,MAAM,EAAE,SAAS,EAAe;IACrF,MAAM,cAAc,IAAI,OAAO,WAAW;IAC5C,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,kIAAA,CAAA,eAAY;gBAAC,OAAM;gBAAc,QAAQ;gBAAQ,WAAW;;;;;;0BAC7D,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC,gIAAA,CAAA,OAAI;;sCACH,8OAAC,gIAAA,CAAA,aAAU;sCACT,cAAA,8OAAC,gIAAA,CAAA,YAAS;0CAAC;;;;;;;;;;;sCAEb,8OAAC,gIAAA,CAAA,cAAW;4BAAC,WAAU;;8CACrB,8OAAC;oCAAE,WAAU;;wCAAY;wCACiH;wCAAY;;;;;;;8CAGtJ,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,8OAAC;8CAAE;;;;;;8CAIH,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,8OAAC;8CAAE;;;;;;8CAGH,8OAAC;oCAAG,WAAU;;sDACV,8OAAC;;8DAAG,8OAAC;8DAAE;;;;;;gDAAmB;;;;;;;sDAC1B,8OAAC;;8DAAG,8OAAC;8DAAE;;;;;;gDAAkB;;;;;;;;;;;;;8CAG7B,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,8OAAC;8CAAE;;;;;;8CAGH,8OAAC;8CAAE;;;;;;8CAIH,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,8OAAC;8CAAE;;;;;;8CAIH,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACtD,8OAAC;8CAAE;;;;;;8CAIJ,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,8OAAC;8CAAE;;;;;;8CAIH,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,8OAAC;8CAAE;;;;;;8CAIF,8OAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACxD,8OAAC;8CAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQf","debugId":null}},
    {"offset": {"line": 648, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/AppContentWrapper.tsx"],"sourcesContent":["\n\n\"use client\";\n\nimport React, { useState, useCallback, useMemo, useEffect, useRef } from 'react';\nimport { BottomNav } from '@/components/BottomNav';\nimport { MatchesScreen } from './screens/MatchesScreen';\nimport { CompetitionsScreen } from './screens/CompetitionsScreen';\nimport { AllCompetitionsScreen } from './screens/AllCompetitionsScreen';\nimport { NewsScreen } from './screens/NewsScreen';\nimport { SettingsScreen } from './screens/SettingsScreen';\nimport { CompetitionDetailScreen } from './screens/CompetitionDetailScreen';\nimport { TeamDetailScreen } from './screens/TeamDetailScreen';\nimport { PlayerDetailScreen } from './screens/PlayerDetailScreen';\nimport { AdminFavoriteTeamScreen } from './screens/AdminFavoriteTeamScreen';\nimport { ProfileScreen } from './screens/ProfileScreen';\nimport { SeasonPredictionsScreen } from './screens/SeasonPredictionsScreen';\nimport { SeasonTeamSelectionScreen } from './screens/SeasonTeamSelectionScreen';\nimport { SeasonPlayerSelectionScreen } from './screens/SeasonPlayerSelectionScreen';\nimport { AddEditNewsScreen } from './screens/AddEditNewsScreen';\nimport { ManagePinnedMatchScreen } from './screens/ManagePinnedMatchScreen';\nimport MatchDetailScreen from './screens/MatchDetailScreen';\nimport { NotificationSettingsScreen } from './screens/NotificationSettingsScreen';\nimport { GeneralSettingsScreen } from './screens/GeneralSettingsScreen';\nimport PrivacyPolicyScreen from './privacy-policy/page';\nimport TermsOfServiceScreen from './terms-of-service/page';\nimport { GoProScreen } from './screens/GoProScreen';\nimport type { ScreenKey } from './page';\n\nimport { useAd, SplashScreenAd, BannerAd } from '@/components/AdProvider';\nimport { useAuth, useFirestore } from '@/firebase';\nimport { Button } from '@/components/ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport { LogOut, User as UserIcon, Loader2 } from 'lucide-react';\nimport { signOut } from '@/lib/firebase-client';\nimport { cn } from '@/lib/utils';\nimport { ManageTopScorersScreen } from './screens/ManageTopScorersScreen';\nimport { IraqScreen } from './screens/IraqScreen';\nimport { PredictionsScreen } from './screens/PredictionsScreen';\nimport { doc, onSnapshot, getDocs, collection, updateDoc, deleteField, writeBatch, setDoc } from 'firebase/firestore';\nimport type { Favorites } from '@/lib/types';\nimport { getLocalFavorites, setLocalFavorites, GUEST_MODE_KEY } from '@/lib/local-favorites';\nimport { AnimatePresence, motion } from 'framer-motion';\nimport { OnboardingHints } from '@/components/OnboardingHints';\nimport { FirestorePermissionError } from '@/firebase/errors';\nimport { errorEmitter } from '@/firebase/error-emitter';\n\nconst screenConfig: Record<string, { component: React.ComponentType<any>;}> = {\n  Matches: { component: MatchesScreen },\n  Competitions: { component: CompetitionsScreen },\n  AllCompetitions: { component: AllCompetitionsScreen },\n  News: { component: NewsScreen },\n  Settings: { component: SettingsScreen },\n  CompetitionDetails: { component: CompetitionDetailScreen },\n  TeamDetails: { component: TeamDetailScreen },\n  PlayerDetails: { component: PlayerDetailScreen },\n  AdminFavoriteTeamDetails: { component: AdminFavoriteTeamScreen },\n  Profile: { component: ProfileScreen },\n  SeasonPredictions: { component: SeasonPredictionsScreen },\n  SeasonTeamSelection: { component: SeasonTeamSelectionScreen },\n  SeasonPlayerSelection: { component: SeasonPlayerSelectionScreen },\n  AddEditNews: { component: AddEditNewsScreen },\n  ManagePinnedMatch: { component: ManagePinnedMatchScreen },\n  MatchDetails: { component: MatchDetailScreen },\n  NotificationSettings: { component: NotificationSettingsScreen },\n  GeneralSettings: { component: GeneralSettingsScreen },\n  PrivacyPolicy: { component: PrivacyPolicyScreen },\n  TermsOfService: { component: TermsOfServiceScreen },\n  GoPro: { component: GoProScreen },\n  ManageTopScorers: { component: ManageTopScorersScreen },\n  MyCountry: { component: IraqScreen },\n  Predictions: { component: PredictionsScreen },\n};\n\n\nconst mainTabs: ScreenKey[] = ['Matches', 'MyCountry', 'Predictions', 'Competitions', 'News', 'Settings'];\n\ntype StackItem = {\n  key: string;\n  screen: ScreenKey;\n  props?: Record<string, any>;\n};\n\nexport const ProfileButton = () => {\n    const { user } = useAuth();\n\n    const handleSignOut = async () => {\n        await signOut();\n    };\n    \n    const navigateToProfile = () => {\n        if ((window as any).appNavigate) {\n            (window as any).appNavigate('Profile');\n        }\n    };\n    \n    const navigateToLogin = () => {\n        localStorage.removeItem(GUEST_MODE_KEY);\n        window.location.reload();\n    }\n\n\n    if (!user) {\n        return (\n            <Button variant=\"ghost\" size=\"icon\" className=\"h-7 w-7 rounded-full\" onClick={navigateToLogin}>\n                <UserIcon className=\"h-4 w-4\" />\n            </Button>\n        );\n    }\n\n    return (\n        <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n                <Button variant=\"ghost\" className=\"relative h-7 w-7 rounded-full\">\n                    <Avatar className=\"h-7 w-7\">\n                        <AvatarImage src={user.photoURL || ''} alt={user.displayName || ''} />\n                        <AvatarFallback>{user.displayName?.charAt(0)}</AvatarFallback>\n                    </Avatar>\n                </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent className=\"w-56\" align=\"end\" forceMount>\n                <DropdownMenuLabel className=\"font-normal\">\n                    <div className=\"flex flex-col space-y-1\">\n                        <p className=\"text-sm font-medium leading-none\">{user.displayName}</p>\n                        <p className=\"text-xs leading-none text-muted-foreground\">\n                            {user.email}\n                        </p>\n                    </div>\n                </DropdownMenuLabel>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem onClick={navigateToProfile}>\n                    <UserIcon className=\"mr-2 h-4 w-4\" />\n                    <span>الملف الشخصي</span>\n                </DropdownMenuItem>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem onClick={handleSignOut}>\n                    <LogOut className=\"mr-2 h-4 w-4\" />\n                    <span>تسجيل الخروج</span>\n                </DropdownMenuItem>\n            </DropdownMenuContent>\n        </DropdownMenu>\n    );\n};\n\n\nexport function AppContentWrapper({ showHints, onHintsDismissed }: { showHints: boolean, onHintsDismissed: () => void }) {\n  const { user, isUserLoading } = useAuth();\n  const { db } = useFirestore();\n  const [favorites, setFavorites] = useState<Partial<Favorites>>({});\n  const [customNames, setCustomNames] = useState<{ [key: string]: Map<number | string, string> } | null>(null);\n  \n  const [navigationState, setNavigationState] = useState<{ activeTab: ScreenKey, stacks: Record<string, StackItem[]> }>({\n    activeTab: 'Matches',\n    stacks: {\n        'Matches': [{ key: 'Matches-0', screen: 'Matches' }],\n        'Competitions': [{ key: 'Competitions-0', screen: 'Competitions' }],\n        'News': [{ key: 'News-0', screen: 'News' }],\n        'MyCountry': [{ key: 'MyCountry-0', screen: 'MyCountry' }],\n        'Predictions': [{ key: 'Predictions-0', screen: 'Predictions' }],\n        'Settings': [{ key: 'Settings-0', screen: 'Settings' }],\n    },\n  });\n\n  const { showSplashAd, showBannerAd } = useAd();\n  const keyCounter = useRef(1);\n\n  const fetchCustomNames = useCallback(async () => {\n    if (!db) {\n        setCustomNames({ leagues: new Map(), teams: new Map(), countries: new Map(), continents: new Map(), players: new Map(), coaches: new Map() });\n        return;\n    }\n    try {\n        const [leaguesSnap, countriesSnap, continentsSnap, teamsSnap, playersSnap, coachesSnap] = await Promise.all([\n            getDocs(collection(db, 'leagueCustomizations')),\n            getDocs(collection(db, 'countryCustomizations')),\n            getDocs(collection(db, 'continentCustomizations')),\n            getDocs(collection(db, 'teamCustomizations')),\n            getDocs(collection(db, 'playerCustomizations')),\n            getDocs(collection(db, 'coachCustomizations')),\n        ]);\n\n        const newNames = {\n            leagues: new Map<number | string, string>(),\n            countries: new Map<number | string, string>(),\n            continents: new Map<number | string, string>(),\n            teams: new Map<number | string, string>(),\n            players: new Map<number | string, string>(),\n            coaches: new Map<number | string, string>()\n        };\n        leaguesSnap.forEach(doc => newNames.leagues.set(Number(doc.id), doc.data().customName));\n        countriesSnap.forEach(doc => newNames.countries.set(doc.id, doc.data().customName));\n        continentsSnap.forEach(doc => newNames.continents.set(doc.id, doc.data().customName));\n        teamsSnap.forEach(doc => newNames.teams.set(Number(doc.id), doc.data().customName));\n        playersSnap.forEach(doc => newNames.players.set(Number(doc.id), doc.data().customName));\n        coachesSnap.forEach(doc => newNames.coaches.set(Number(doc.id), doc.data().customName));\n        \n        setCustomNames(newNames);\n\n    } catch (error) {\n        console.warn(\"Failed to fetch custom names, using empty maps.\", error);\n        setCustomNames({ leagues: new Map(), teams: new Map(), countries: new Map(), continents: new Map(), players: new Map(), coaches: new Map() });\n    }\n  }, [db]);\n  \n  useEffect(() => {\n    fetchCustomNames();\n  }, [fetchCustomNames]);\n  \n const handleSetFavorites = useCallback((updater: React.SetStateAction<Partial<Favorites>>) => {\n    setFavorites(currentFavorites => {\n        const newFavorites = typeof updater === 'function' ? updater(currentFavorites) : updater;\n\n        if (!user || user.isAnonymous) {\n            setLocalFavorites(newFavorites);\n        } else if (db) {\n            const favDocRef = doc(db, 'users', user.uid, 'favorites', 'data');\n            // This setDoc should merge the entire new favorites object.\n            // Be cautious if you only want to update a single field.\n            setDoc(favDocRef, newFavorites, { merge: true }).catch(err => {\n                console.error(\"Firestore update failed:\", err);\n                errorEmitter.emit('permission-error', new FirestorePermissionError({\n                    path: favDocRef.path,\n                    operation: 'write',\n                    requestResourceData: newFavorites,\n                }));\n            });\n        }\n        \n        return newFavorites;\n    });\n}, [user, db]);\n\n\n  useEffect(() => {\n    let favsUnsub: (() => void) | null = null;\n    const localFavsListener = () => {\n        setFavorites(getLocalFavorites());\n    };\n\n    const cleanup = () => {\n      if (favsUnsub) {\n        favsUnsub();\n        favsUnsub = null;\n      }\n      window.removeEventListener('localFavoritesChanged', localFavsListener);\n    };\n\n    if (isUserLoading) {\n      return;\n    }\n\n    cleanup();\n\n    if (user && db && !user.isAnonymous) {\n      const favDocRef = doc(db, 'users', user.uid, 'favorites', 'data');\n      favsUnsub = onSnapshot(\n        favDocRef,\n        (doc) => {\n          setFavorites(doc.exists() ? (doc.data() as Favorites) : {});\n        },\n        (error) => {\n          console.error(\"Error listening to remote favorites:\", error);\n          setFavorites({});\n        }\n      );\n    } else {\n      setFavorites(getLocalFavorites());\n      window.addEventListener('localFavoritesChanged', localFavsListener);\n    }\n\n    return () => cleanup();\n  }, [user, db, isUserLoading]);\n\n\n  const goBack = useCallback(() => {\n    setNavigationState(prevState => {\n        const currentStack = prevState.stacks[prevState.activeTab];\n        if (currentStack.length > 1) {\n            return {\n                ...prevState,\n                stacks: {\n                    ...prevState.stacks,\n                    [prevState.activeTab]: currentStack.slice(0, -1),\n                }\n            };\n        }\n        if (!mainTabs.includes(prevState.activeTab)) {\n            return { ...prevState, activeTab: 'Matches' };\n        }\n        return prevState;\n    });\n  }, []);\n\n  const navigate = useCallback((screen: ScreenKey, props?: Record<string, any>) => {\n      const newKey = `${screen}-${keyCounter.current++}`;\n      \n      setNavigationState(prevState => {\n          if (mainTabs.includes(screen)) {\n              return {\n                  ...prevState,\n                  activeTab: screen,\n                  stacks: {\n                      ...prevState.stacks,\n                      [screen]: [{ key: `${screen}-0`, screen: screen, props }]\n                  }\n              };\n          }\n          \n          const newItem = { key: newKey, screen, props };\n          const currentStack = prevState.stacks[prevState.activeTab] || [];\n          return {\n              ...prevState,\n              stacks: {\n                  ...prevState.stacks,\n                  [prevState.activeTab]: [...currentStack, newItem]\n              }\n          };\n      });\n  }, []);\n  \n  useEffect(() => {\n      if (typeof window !== 'undefined') {\n          (window as any).appNavigate = navigate;\n      }\n  }, [navigate]);\n  \n  const isDataReady = customNames !== null && !isUserLoading;\n\n  if (!isDataReady) {\n    return null;\n  }\n\n  if (showSplashAd) {\n    return <SplashScreenAd />;\n  }\n  \n  const activeStack = navigationState.stacks[navigationState.activeTab] || [];\n  \n  const pageVariants = {\n      initial: { x: '100%', opacity: 0 },\n      in: { x: 0, opacity: 1 },\n      out: { x: '-100%', opacity: 0 },\n  };\n\n  const tabVariants = {\n      initial: { opacity: 0 },\n      in: { opacity: 1 },\n      out: { opacity: 0 },\n  }\n\n  const pageTransition = { type: 'tween', ease: 'anticipate', duration: 0.4 };\n  const tabTransition = { type: 'tween', ease: 'easeIn', duration: 0.2 };\n  \n  const baseScreenProps = {\n    navigate,\n    goBack,\n    customNames,\n    favorites,\n    setFavorites: handleSetFavorites,\n    onCustomNameChange: fetchCustomNames,\n  };\n\n  return (\n        <main className=\"h-screen w-screen bg-background flex flex-col\">\n        {showHints && <OnboardingHints onDismiss={onHintsDismissed} activeTab={navigationState.activeTab} />}\n        <div className=\"relative flex-1 flex flex-col overflow-hidden\">\n             <AnimatePresence initial={false}>\n                {mainTabs.map(tabKey => {\n                    const stack = navigationState.stacks[tabKey];\n                    if (!stack || stack.length === 0) return null;\n                    const isActiveTab = navigationState.activeTab === tabKey;\n                    if (!isActiveTab) return null;\n\n                    return (\n                         <motion.div\n                            key={tabKey}\n                            className=\"absolute inset-0 flex flex-col\"\n                            initial=\"initial\"\n                            animate=\"in\"\n                            exit=\"out\"\n                            variants={tabVariants}\n                            transition={tabTransition}\n                        >\n                             <AnimatePresence initial={false}>\n                                {stack.map((stackItem, index) => {\n                                    const isVisible = index === stack.length - 1;\n                                    const Component = screenConfig[stackItem.screen]?.component;\n                                    if (!Component) return null;\n                                    \n                                    const screenProps = {\n                                        ...baseScreenProps,\n                                        ...stackItem.props,\n                                        canGoBack: stack.length > 1,\n                                        isVisible,\n                                    };\n\n                                    return (\n                                        <motion.div\n                                            key={stackItem.key}\n                                            className=\"absolute inset-0 flex flex-col bg-background\"\n                                            initial=\"initial\"\n                                            animate={isVisible ? \"in\" : \"out\"}\n                                            exit=\"out\"\n                                            variants={pageVariants}\n                                            transition={pageTransition}\n                                            style={{\n                                                zIndex: index + 1,\n                                                pointerEvents: isVisible ? 'auto' : 'none',\n                                            }}\n                                        >\n                                            <Component {...screenProps} />\n                                        </motion.div>\n                                    )\n                                })}\n                             </AnimatePresence>\n                        </motion.div>\n                    )\n                })}\n            </AnimatePresence>\n        </div>\n        \n        {showBannerAd && <BannerAd />}\n        {mainTabs.includes(activeStack[activeStack.length - 1]?.screen) && <BottomNav activeScreen={navigationState.activeTab} onNavigate={(screen) => navigate(screen)} />}\n        </main>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1392, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/page.tsx"],"sourcesContent":["\n\"use client\";\n\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useAuth, useFirestore } from '@/firebase';\nimport { AppContentWrapper } from './AppContentWrapper';\nimport { AdProvider } from '@/components/AdProvider';\nimport { Loader2 } from 'lucide-react';\nimport { FavoriteSelectionScreen } from './screens/FavoriteSelectionScreen';\nimport { doc, getDoc, setDoc, type Firestore } from 'firebase/firestore';\nimport { FirestorePermissionError } from '@/firebase/errors';\nimport { errorEmitter } from '@/firebase/error-emitter';\nimport { NabdAlMalaebLogo } from '@/components/icons/NabdAlMalaebLogo';\nimport { WelcomeScreen, GUEST_MODE_KEY } from './screens/WelcomeScreen';\nimport { handleNewUser } from '@/lib/firebase-client';\nimport { type User } from 'firebase/auth';\nimport { ProfileScreen } from './screens/ProfileScreen';\nimport { OnboardingHints } from '@/components/OnboardingHints';\n\nexport type ScreenKey = 'Welcome' | 'SignUp' | 'Matches' | 'Competitions' | 'AllCompetitions' | 'News' | 'Settings' | 'CompetitionDetails' | 'TeamDetails' | 'PlayerDetails' | 'AdminFavoriteTeamDetails' | 'Profile' | 'SeasonPredictions' | 'SeasonTeamSelection' | 'SeasonPlayerSelection' | 'AddEditNews' | 'ManageTopScorers' | 'MatchDetails' | 'NotificationSettings' | 'GeneralSettings' | 'ManagePinnedMatch' | 'PrivacyPolicy' | 'TermsOfService' | 'FavoriteSelection' | 'GoPro' | 'MyCountry' | 'Predictions';\n\nexport type ScreenProps = {\n  navigate: (screen: ScreenKey, props?: Record<string, any>) => void;\n  goBack: () => void;\n  canGoBack: boolean;\n  favorites?: any; // To accept props from wrapper\n  customNames?: any; // To accept props from wrapper\n};\n\nconst GUEST_ONBOARDING_COMPLETE_KEY = 'goalstack_guest_onboarding_complete';\nconst NEW_USER_HINTS_SHOWN_KEY = 'goalstack_new_user_hints_shown';\n\n\nconst LoadingSplashScreen = () => (\n    <div className=\"flex flex-col items-center justify-center h-screen bg-background text-center\">\n        <NabdAlMalaebLogo className=\"h-24 w-24 mb-4\" />\n        <h1 className=\"text-2xl font-bold font-headline mb-8 text-primary\">نبض الملاعب</h1>\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n    </div>\n);\n\n\nconst OnboardingFlow = ({ user, isGuest }: { user: User | null, isGuest: boolean }) => {\n    const { db } = useFirestore();\n    const [onboardingComplete, setOnboardingComplete] = useState(false);\n    const [isLoading, setIsLoading] = useState(true);\n    const [needsDisplayName, setNeedsDisplayName] = useState(false);\n    const [isNewUser, setIsNewUser] = useState(false);\n\n\n    useEffect(() => {\n        const checkOnboarding = async () => {\n            setIsLoading(true);\n            if (isGuest) {\n                const guestOnboardingComplete = localStorage.getItem(GUEST_ONBOARDING_COMPLETE_KEY) === 'true';\n                setOnboardingComplete(guestOnboardingComplete);\n                if (!guestOnboardingComplete) setIsNewUser(true);\n                setIsLoading(false);\n                return;\n            }\n\n            if (!user || !db) {\n                setIsLoading(false);\n                return;\n            };\n\n            const userDocRef = doc(db, 'users', user.uid);\n            try {\n                const userDoc = await getDoc(userDocRef);\n                const userData = userDoc.data();\n                const isComplete = userData?.onboardingComplete || false;\n                setOnboardingComplete(isComplete);\n                \n                if (!isComplete) setIsNewUser(true);\n                \n                if (user.isAnonymous) {\n                  setNeedsDisplayName(false);\n                } else {\n                  setNeedsDisplayName(!userData?.displayName || userData.displayName.startsWith('مستخدم_'));\n                }\n\n            } catch (error) {\n                console.error(\"Error checking onboarding status:\", error);\n                setOnboardingComplete(false);\n            } finally {\n                setIsLoading(false);\n            }\n        };\n        checkOnboarding();\n    }, [user, db, isGuest]);\n\n    const handleOnboardingComplete = async () => {\n        setIsNewUser(true); // Mark as new user to show hints after this step\n        if (isGuest) {\n            localStorage.setItem(GUEST_ONBOARDING_COMPLETE_KEY, 'true');\n            setOnboardingComplete(true);\n            return;\n        }\n\n        if (!user || !db) return;\n        \n        const userDocRef = doc(db, 'users', user.uid);\n        try {\n            await setDoc(userDocRef, { onboardingComplete: true }, { merge: true });\n            setOnboardingComplete(true);\n            const userDoc = await getDoc(userDocRef);\n            if (!user.isAnonymous && (!userDoc.data()?.displayName || userDoc.data()?.displayName.startsWith('مستخدم_'))) {\n                setNeedsDisplayName(true);\n            }\n        } catch (error) {\n            const permissionError = new FirestorePermissionError({ path: userDocRef.path, operation: 'update', requestResourceData: { onboardingComplete: true } });\n            errorEmitter.emit('permission-error', permissionError);\n        }\n    };\n    \n    const handleDisplayNameSet = () => {\n        setNeedsDisplayName(false);\n        if (onboardingComplete && typeof window !== 'undefined') {\n            (window as any).appNavigate('Matches');\n        }\n    }\n    \n    const onHintsDismissed = useCallback(() => {\n        if (typeof window !== 'undefined') {\n            sessionStorage.setItem(NEW_USER_HINTS_SHOWN_KEY, 'true');\n        }\n    }, []);\n    \n    const showHints = useMemo(() => {\n        if (typeof window === 'undefined') return false; // Guard against SSR\n        return isNewUser && sessionStorage.getItem(NEW_USER_HINTS_SHOWN_KEY) !== 'true';\n    }, [isNewUser]);\n\n    if (isLoading) {\n        return <LoadingSplashScreen />;\n    }\n\n    if (!onboardingComplete) {\n        return <FavoriteSelectionScreen onOnboardingComplete={handleOnboardingComplete} />;\n    }\n    \n    if (needsDisplayName) {\n        const pseudoNavigate = () => {};\n        const pseudoGoBack = () => handleDisplayNameSet();\n        return <ProfileScreen navigate={pseudoNavigate} goBack={handleDisplayNameSet} canGoBack={false} isNewUserFlow onFlowComplete={handleDisplayNameSet}/>;\n    }\n\n    return (\n        <AdProvider>\n            <AppContentWrapper showHints={showHints} onHintsDismissed={onHintsDismissed} />\n        </AdProvider>\n    );\n};\n\n\nexport default function Home() {\n    const { user, isUserLoading } = useAuth();\n    const [isGuest, setIsGuest] = useState(false);\n    const [isCheckingGuest, setIsCheckingGuest] = useState(true);\n\n    useEffect(() => {\n        // This effect runs only on the client, preventing hydration errors.\n        const guestMode = localStorage.getItem(GUEST_MODE_KEY) === 'true';\n        setIsGuest(guestMode);\n        setIsCheckingGuest(false);\n    }, []);\n    \n    if (isUserLoading || isCheckingGuest) {\n        return <LoadingSplashScreen />;\n    }\n\n    if (!user && !isGuest) {\n        return <WelcomeScreen />;\n    }\n\n    // Pass isGuest flag to OnboardingFlow\n    return <OnboardingFlow user={user} isGuest={isGuest} />;\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}